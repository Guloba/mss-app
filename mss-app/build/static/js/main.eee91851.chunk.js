(this["webpackJsonpmss-app"]=this["webpackJsonpmss-app"]||[]).push([[0],{111:function(e,t,c){},113:function(e,t,c){},114:function(e,t,c){"use strict";c.r(t);var a=c(0),s=c.n(a),n=c(17),i=c.n(n),o=(c(96),c(15)),r=(c.p,c(97),c(98),c(157)),l=c(147),j=c(148),d=c(61),u=c.n(d),b=c(62),h=c.n(b),O=c(68),m=c.n(O),p=(c(99),c(44)),x=c(146),f=c(82),g=c.n(f),v=c(42),S=v.a.initializeApp({apiKey:"AIzaSyBJeae1XQhVB3Loj6II7EQRwdq2HBsJTOI",authDomain:"messapp-ba3f8.firebaseapp.com",projectId:"messapp-ba3f8",storageBucket:"messapp-ba3f8.appspot.com",messagingSenderId:"671116767769",appId:"1:671116767769:web:0fb2a437e0c72cd811f088",measurementId:"G-XBJWG2JJ2R"}).firestore(),N=v.a.auth(),y=new v.a.auth.GoogleAuthProvider,C=S,I=c(5);var R=function(e){var t,c=e.channelname,s=e.id,n=Object(a.useState)(""),i=Object(o.a)(n,2),l=i[0],j=i[1],d=Object(a.useState)([]),u=Object(o.a)(d,2),b=u[0],h=u[1];return Object(a.useEffect)((function(){j(Math.floor(1e4*Math.random()))}),[]),Object(a.useEffect)((function(){s&&C.collection("Rooms").doc(s).collection("Messages").orderBy("timestamp","asc").onSnapshot((function(e){h(e.docs.map((function(e){return e.data()})))}))}),[s]),Object(I.jsx)(p.b,{className:"link",to:"/rooms/".concat(s),children:Object(I.jsxs)("div",{className:"chats",children:[Object(I.jsx)(r.a,{src:"https://avatars.dicebear.com/api/human/".concat(l,".svg")}),Object(I.jsxs)("div",{className:"chat-info",children:[Object(I.jsx)("h2",{children:c}),(null===b||void 0===b?void 0:b.length)>0?Object(I.jsx)("p",{children:null===(t=b[b.length-1])||void 0===t?void 0:t.text}):Object(I.jsx)("p",{className:"empty-array",children:"This channel has no messages"})]}),Object(I.jsx)(x.a,{className:"badge",badgeContent:null===b||void 0===b?void 0:b.length,color:"secondary",children:Object(I.jsx)(g.a,{})})]})})},T=c(31),E=(c(77),Object(a.createContext)()),w=function(e){var t=e.reducer,c=e.initialState,s=e.children;return Object(I.jsx)(E.Provider,{value:Object(a.useReducer)(t,c),children:s})},M=function(){return Object(a.useContext)(E)};T.a.configure();var k=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),c=t[0],s=t[1],n=M(),i=Object(o.a)(n,1)[0].user,d=Object(a.useState)(""),b=Object(o.a)(d,2);return b[0],b[1],Object(a.useEffect)((function(){var e=C.collection("Rooms").onSnapshot((function(e){s(e.docs.map((function(e){return{data:e.data(),id:e.id}})))}));return function(){e()}}),[]),Object(I.jsxs)("div",{className:"side-bar",children:[Object(I.jsxs)("div",{className:"sidebar-header",children:[Object(I.jsx)(r.a,{src:null===i||void 0===i?void 0:i.photoURL}),Object(I.jsxs)("div",{className:"header-right",children:[Object(I.jsx)(l.a,{onClick:function(){C.collection("Rooms").onSnapshot((function(e){s(e.docs.map((function(e){return{data:e.data(),id:e.id}})))}))},children:Object(I.jsx)(j.a,{})}),Object(I.jsx)(l.a,{children:Object(I.jsx)(u.a,{})}),Object(I.jsx)(l.a,{children:Object(I.jsx)(h.a,{})})]})]}),Object(I.jsx)("div",{className:"sidebar-search",children:Object(I.jsxs)("div",{className:"search-container",children:[Object(I.jsx)(m.a,{}),Object(I.jsx)("input",{onChange:function(e){e.preventDefault();var t,a=e.target.value.toLowerCase();t=c.filter((function(e){return-1!=e.data.name.toLowerCase().search(a)})),s(t)},type:"text",placeholder:"Search or start new chat"})]})}),Object(I.jsxs)("div",{className:"sidebar-chats",children:[Object(I.jsx)("div",{onClick:function(){var e=prompt("Enter your message here");e&&(C.collection("Rooms").add({name:e}),new Audio("https://drive.google.com/uc?export=download&id=1M95VOpto1cQ4FQHzNBaLf0WFQglrtWi7").play(),T.a.success("Channel Successfully Created",{position:T.a.POSITION.TOP_RIGHT}))},className:"chat-head",children:Object(I.jsx)("h2",{children:"Add New Channel"})}),c.map((function(e){return Object(I.jsx)(R,{id:e.id,channelname:e.data.name},e.id)}))]})]})},B=(c(111),c(16)),L=c(85),P=c(149),F=c(151),A=c(152),D=c(153),Q=c(154),_=c(150),G=c(156),J=c(83),W=c.n(J),H=c(84),U=c.n(H),z=c(64),V=c(86);Object(P.a)({avatar:{backgroundColor:z.a[100],color:z.a[600]}});var X=function(e){e.date;var t,c,s=Object(a.useState)(!1),n=Object(o.a)(s,2),i=n[0],d=n[1],b=Object(B.f)().roomId,O=Object(a.useState)(""),m=Object(o.a)(O,2),p=m[0],x=m[1],f=Object(a.useState)([]),g=Object(o.a)(f,2),S=g[0],y=g[1],R=M(),E=Object(o.a)(R,2),w=E[0].user,k=E[1],P=Object(a.useState)(""),J=Object(o.a)(P,2),H=J[0],z=J[1];return Object(a.useEffect)((function(){b&&(C.collection("Rooms").doc(b).collection("Messages").orderBy("timestamp","asc").onSnapshot((function(e){y(e.docs.map((function(e){return e.data()})))})),C.collection("Rooms").doc(b).onSnapshot((function(e){z(e.data().name)})))}),[b]),Object(I.jsxs)("div",{className:"chat-field",children:[Object(I.jsxs)("div",{className:"message-header",children:[Object(I.jsx)(r.a,{src:"https://avatars.dicebear.com/api/human/88.svg"}),Object(I.jsxs)("div",{className:"header_info",children:[Object(I.jsx)("h3",{children:H}),Object(I.jsxs)("p",{children:["Last seen \xa0",S.length>0?Object(I.jsxs)("small",{className:"last-seen",children:[new Date(null===(t=S[S.length-1])||void 0===t||null===(c=t.timestamp)||void 0===c?void 0:c.toDate()).toLocaleString()," "]}):Object(I.jsx)("small",{className:"no-lastseen",children:"No user visited this channel"})]})]}),Object(I.jsxs)("div",{className:"message-right",children:[Object(I.jsx)(l.a,{children:Object(I.jsx)(j.a,{})}),Object(I.jsx)(l.a,{children:Object(I.jsx)(u.a,{})}),Object(I.jsx)(l.a,{onClick:function(){d(!0)},children:Object(I.jsx)(h.a,{})})]})]}),Object(I.jsx)("div",{className:"message-body",children:S.map((function(e){var t;return Object(I.jsxs)("p",{className:"chat-message ".concat(e.name===w.displayName&&"message-sender"),children:[Object(I.jsx)("span",{className:"username",children:e.name}),Object(I.jsx)("br",{}),e.text,Object(I.jsxs)("small",{className:"time-stamp",children:[" ",L.a(new Date(null===e||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()))," "]})]})}))}),Object(I.jsx)("div",{className:"message-footer",children:Object(I.jsxs)("form",{children:[Object(I.jsx)(V.a,{value:p,onChange:x,placeholder:"Type a message"}),Object(I.jsx)("button",{onClick:function(e){e.preventDefault(),C.collection("Rooms").doc(b).collection("Messages").add({text:p,name:w.displayName,timestamp:v.a.firestore.FieldValue.serverTimestamp()}),new Audio("https://drive.google.com/uc?export=download&id=1M95VOpto1cQ4FQHzNBaLf0WFQglrtWi7").play(),T.a.success("Message Sent Successsfully",{position:T.a.POSITION.TOP_RIGHT}),x("")},type:"submit",children:"Send"})]})}),Object(I.jsxs)(G.a,{position:"top, right",className:"dialogue",onClose:function(){d(!1)},"aria-labelledby":"simple-dialog-title",open:i,children:[Object(I.jsx)(_.a,{id:"simple-dialog-title",children:" Account Settings"}),Object(I.jsxs)(F.a,{children:[Object(I.jsxs)(A.a,{onClick:function(){b&&C.collection("Rooms").doc(b).collection("Messages").get().then((function(e){e.forEach((function(e){e.ref.delete()}))})),T.a.success("Messages Cleared",{position:T.a.POSITION.TOP_RIGHT}),d(!1)},button:!0,children:[Object(I.jsx)(D.a,{children:Object(I.jsx)(r.a,{children:Object(I.jsx)(W.a,{})})}),Object(I.jsx)(Q.a,{primary:"Clear Chats"})]}),Object(I.jsxs)(A.a,{autoFocus:!0,button:!0,children:[Object(I.jsx)(D.a,{children:Object(I.jsx)(r.a,{children:Object(I.jsx)(U.a,{})})}),Object(I.jsx)(Q.a,{onClick:function(){N.signOut(),k({type:"SET_USER",user:null}),d(!1)},primary:"Logout"})]})]})]})]})},q=(c(113),c(155));var K=function(){return Object(I.jsx)("div",{className:"login",children:Object(I.jsxs)("div",{className:"login-container",children:[Object(I.jsx)("img",{src:"https://image.flaticon.com/icons/png/128/3437/3437364.png"}),Object(I.jsx)("div",{className:"login-text",children:Object(I.jsx)("h2",{children:"Sign in to Message Me "})}),Object(I.jsx)(q.a,{onClick:function(){N.signInWithPopup(y).then((function(e){})).catch((function(e){return alert(e.message)}))},children:" Sign In With Google"})]})})};var Y=function(){var e=M(),t=Object(o.a)(e,2),c=t[0].user,s=t[1];return Object(a.useEffect)((function(){var e=N.onAuthStateChanged((function(e){s(e?{type:"SET_USER",user:e}:{type:"SET_USER",user:null})}));return function(){e()}}),[]),console.log(c),Object(I.jsx)("div",{className:"app",children:c?Object(I.jsx)("div",{className:"main-body",children:Object(I.jsx)(p.a,{children:Object(I.jsxs)(B.c,{children:[Object(I.jsxs)(B.a,{exact:!0,path:"/",children:[Object(I.jsx)(k,{}),Object(I.jsx)(X,{})]}),Object(I.jsxs)(B.a,{exact:!0,path:"/rooms/:roomId",children:[Object(I.jsx)(k,{}),Object(I.jsx)(X,{})]})]})})}):Object(I.jsx)(K,{})})},Z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,159)).then((function(t){var c=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,i=t.getTTFB;c(e),a(e),s(e),n(e),i(e)}))},$=c(43),ee=function(e,t){switch(t.type){case"SET_USER":return Object($.a)(Object($.a)({},e),{},{user:t.user});default:return e}};i.a.render(Object(I.jsx)(s.a.StrictMode,{children:Object(I.jsx)(w,{reducer:ee,initialState:{user:null},children:Object(I.jsx)(Y,{})})}),document.getElementById("root")),Z()},96:function(e,t,c){},97:function(e,t,c){},98:function(e,t,c){},99:function(e,t,c){}},[[114,1,2]]]);
//# sourceMappingURL=main.eee91851.chunk.js.map